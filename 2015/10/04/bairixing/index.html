<!DOCTYPE html><html lang="English,Chinese"><head><meta charset="UTF-8"><meta name="author" content="Bing Xu"><meta name="desciption" content="白日行在编程世界中,一个执著的程序非猿"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>白日行</title><link rel="stylesheet" type="text/css" href="//dn-staticfile.qbox.me/normalize/3.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="/css/carbon.css"></head><body><div id="container"><div id="banner"><h1 id="site-title"><a href="/">XBoOS</a></h1><p id="site-subtitle">极简,至深</p></div><div id="content"><div class="meta"><h2 class="article-title"><a href="/2015/10/04/bairixing/">白日行</a></h2><div class="article-date"><a href="javascript:void(0);" class="extra-switch">2015-10-04</a></div></div><div class="extra">Tags: 無</div><div class="extra">Categorias: 無</div><div class="article-content"><div class="gallery"></div><h1>开博之篇</h1>
<p>说来有些惭愧,距离师兄帮助我搭起来博客已经有不短的日子了.一直有写技术博客的想法,但有时总会觉得自己道行之浅有班门弄斧之嫌.这个想法在看了很多别人的博客之后有很大改观.人为什么要写博客,这与著书立说不同,未必是一个无懈可击数经考证的结论,而可以是自己思想的整个孵化过程记载.目的本身生发自与同自我的交互,然后才是读者(而且是否有读者都是后话),是同自我对话的地方.而且随着自媒体发展和社交成本的降低,我们分享信息的方法也越来越亲民,譬如博客.所以还是像很多博主说的一样,博客即在于总结与分享.</p>
<h1>我和XBoOS</h1>
<p>作为一名程序员,媛而非猿,博客更多的还是会关于热爱的编程,当然也不限于技术博客,因为我还算是一个爱和熟人侃点什么的人,虽然我是INTP人格.</p>
<p>今年大四了,不久也要离开校园,博客开始在现在,也算是人生两个阶段交接的一个见证.HKU奉行通识教育的原因,正式接触程序大概要从大二算起,但心之所向已经足够.隐约觉得走到了一个技术成长升华的节点,大概是量变产生质变的一个instance.最近正式入了Vim党,编程的主力也从C++/Java切换成了Python,同时开了很多个线程在学函数式编程,AI,ML.很忙不过乐在其中.</p>
<p>我喜欢极简的风格,大多数时候,simple's the best. 环节越多,意味着拥有了更多错误的可能.而且透彻人心的往往是简单的道理.极简才能至深.</p>
<p>在博客的subtitle里面提到了白日行,其实是白夜行的反义.CS的无疆又新奇的世界对于所有热爱它的程序员来说大概像白日一样吧,而且永远不会停止前行. 前几周忙中偷闲迷上了东野圭吾先生的书,一连把几部经典都看完了,最近实在没有时间继续读了.不过印象最深的却是看完最难过的一本 &lt;<em>白夜行</em>&gt;.具体的读后感就不谈了,只有一点是白夜行的社会背景是日本电子游戏萌芽的一个阶段,也是一个编程平民化的阶段.</p>
<p>还想提一点,就是作为女生要说的话了,希望更多的女生也来编程(哈,呼应一下世界各处涌起的呼吁女性编程的运动).女性漂亮地活过了石器时代,农耕时代,工业时代,那在如今不需要muscle来打鱼狩猎的信息时代便没有任何生理劣势了.不能瞬间生成那么多的ATP或者肾上腺素,然而同样有高度进化的大脑. Time to rescue the world.</p>
<p>关于我,关于博客,先说到这里.必然后会有期,人们大概都可以在自己的博客中找到归属感,像一个家,即便很忙也要常回来看看,我也许已经沉醉在这种归属感里面了.</p>
<h1>今天的一个问题</h1>
<h2>Windows/Unix line ending</h2>
<p>最近在帮金融系的教授做研究助理,帮教授写程序.有编程基础的教授化身产品经理的模样,不断地抛出需求.我要做的就是为教授的金融模型或者理论做大量的数据处理,于是写了不少python和shell scprits. 有时教授会形成习惯了甚至把我当IT使用,死机窗口卡顿的时候呼唤我.....不过被信任还是很荣幸的.</p>
<p>然而出现了这样一个问题.</p>
<p>我在 Mac上写好的shell script并且写过小测试试了下发给教授,教授run的时候却出现syntax error,could not find expecting...bla bla...</p>
<p>第一个反应当然是自我怀疑地重新run了我本地的script.Bam! Nothing is wrong!然后怀疑教授,让教授重新下载脚本重run. The same problem.....然后我就和见鬼了一样看着两台机子上的script大致比对...&quot;shell不可能有indentation的问题啊...then what's wrong? &quot;,然后我想到那些诡异的隐藏符,比如换行之类的,然后快速在教授机子上重写了一遍script,save it and run. Went smoothly as expected.</p>
<p>一个肉眼不可见的问题,我想起了那些诡异的隐藏符.那么可能就是操作系统带来的差别,我查了mac本地的文件类型是unix.</p>
<p>Cited from stackoverflow</p>
<pre><code>From samjudson:
This is only a difference in text files, where UNIX uses a single Line Feed (LF) to signify a new line, Windows uses a Carriage Return/Line Feed (CRLF) and Mac uses just a CR.  

Cebjyre elaborates:
OS X uses LF, the same as UNIX - MacOS 9 and below did use CR though.
</code></pre>
<h2>Found our Murderer</h2>
<p>在不同的机器上写出的text file的line ending是不同的,windos/dos 机上为&quot;\r\n&quot;,而Unix/Linux 只有&quot;\n&quot;.</p>
<p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">unix	</span><br><span class="line"><span class="code">	LF only (each line ends with an LF character).  </span></span><br><span class="line"><span class="header">	Unix based systems and Mac OS X and later.</span><br><span class="line">---</span></span><br><span class="line">dos</span><br><span class="line"><span class="code">	CRLF (each line ends with CR then LF).   </span></span><br><span class="line"><span class="code">	DOS and Windows.  </span></span><br><span class="line"><span class="horizontal_rule">---	</span></span><br><span class="line">mac</span><br><span class="line"><span class="code">	CR only (each line ends with a CR character).  </span></span><br><span class="line"><span class="code">	Mac OS version 9 and earlier</span></span><br><span class="line"><span class="code">	later becomes LF</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line">CR is carriage return (return cursor to left margin), which is Ctrl-M or ^M or hex 0D.</span><br><span class="line"></span><br><span class="line">LF is linefeed (move cursor down), which is Ctrl-J or ^J or hex 0A. Sometimes, LF is written as NL (newline).</span><br></pre></td></tr></table></figure></p>
<h2>Conversion between CRLF and Just line feed</h2>
<ol>
<li>
<p>查找替换.<br>
这是最直觉的方法.可以利用自己偏好的Editor查找替换,或者用一些智能的功能.<br>
比如在Vim里可以用:set ff?来查看fileformat. 这里的ff(fileformat 的缩写)是局限于当前buffer的,当文件被读入的时候被Vim赋值,或者可以在command line中指定,fileformat决定了buffer怎样读入一个文件(包括对line ending进行相应的修改),以及可以通过改变fileformat的值对buffer写文件的格式进行修改 :set fileformat=dos/unix/mac</p>
<p>同时还有一个fifleformats的全局选项,是在没有特殊指定的时候vim将按照这些顺序去read这个文件,在mac上会显示fileformats=unix,dos<br>
文件格式的问题会出现^M的乱码,用:e ++ff=dos 去掉.<br>
手动的话可以:%s/^V^M//g</p>
<p>还有一种看到的办法是(未亲测)Notepad++ Edit -&gt; EOL Conversion 里面有已经准备好的选项可以用</p>
<p>然而简单的查找替换的速度有限,在文件不大的时候可以考虑</p>
</li>
</ol>
<ol start="2">
<li>
<p>现有工具</p>
<ul>
<li>
<p>可以用FTP, 在传输之前先敲ascii,会被转换成ascii文件格式,当传到另一个host上时会用合适于它的的格式打开</p>
</li>
<li>
<p>dos2unix 和 unix2dos, 在unix平台上装上可以使用</p>
<pre><code>  dos2unix winfile.txt unixfile.txt
  
  unix2dos unixfile.txt winfile.txt
</code></pre>
</li>
<li>
<p>还有一些脚本方法,没有试过,暂时写在这里</p>
<pre><code>    # 只可以转unix
      tr -d '\15\32' &lt; winfile.txt &gt; unixfile.txt
    
    
    # awk
      awk '{ sub(&quot;\r$&quot;, &quot;&quot;); print }' winfile.txt &gt; unixfile.txt
      awk 'sub(&quot;$&quot;, &quot;\r&quot;)' unixfile.txt &gt; winfile.txt
      
    # perl
      perl -p -e 's/\r$//' &lt; winfile.txt &gt; unixfile.txt 
      perl -p -e 's/\n/\r\n/' &lt; unixfile.txt &gt; winfile.txt
</code></pre>
</li>
</ul>
</li>
<li>
<p>A simple trick<br>
直接拖进chrome/firefox 然后剪切粘贴即可以解决这个问题......仿佛看到了一位生活小能手的同学</p>
</li>
</ol>
</div><div id="disqus_thread" class="comments"><script>//fix for permalink in pages
var path = '2015/10/04/bairixing/'.replace('/index.html', '');
var disqus_shortname = 'xboos';
var disqus_identifier = path;
var disqus_title = '白日行';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</noscript></div><nav class="pagination"></nav><!--mathjax config similar to math.stackexchange--><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    processEscapes: true
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});</script><script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></div><nav id="footer"><ul id="footer-links"><li><a href="/about">關於</a></li><li><a href="/archives">所有文章</a></li><li><a href="/atom.xml" class="out-site">RSS</a></li><li><a href="https://icylogic.net" class="out-site">Theme.Carbon</a></li><li><a href="https://github.com/hexojs/hexo" class="out-site">Hexo</a></li></ul></nav></div></body><script src="//dn-staticfile.qbox.me/jquery/2.1.1/jquery.min.js"></script><script src="//dn-staticfile.qbox.me/jquery.pjax/1.9.2/jquery.pjax.min.js"></script><script src="/js/carbon.js"></script></html>